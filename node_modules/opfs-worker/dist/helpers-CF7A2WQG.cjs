"use strict";const Se={ENOENT:-2,EISDIR:-21,ENOTDIR:-20,EACCES:-13,EEXIST:-17,ENOTEMPTY:-39,EINVAL:-22,EIO:-5,ENOSPC:-28,EBUSY:-16,EINTR:-4,ENOTSUP:-95,ERANGE:-34,EBADF:-9,EROOT:-1};class m extends Error{errno;syscall;path;constructor(e,t,n,r,i){super(e,{cause:i}),this.name=t,this.errno=Se[t]||-1,this.path=n,this.syscall=r}}class K extends m{constructor(e){super("OPFS is not supported in this browser","OPFS_NOT_SUPPORTED",void 0,void 0,e)}}class xe extends m{constructor(e,t,n){super(e,"INVALID_PATH",t,"access",n)}}class j extends m{constructor(e,t,n){const r={file:`File not found: ${t}`,directory:`Directory not found: ${t}`,source:`Source does not exist: ${t}`};super(r[e],"ENOENT",t,"access",n)}}class ee extends m{constructor(e,t,n){super(`Permission denied for ${t} on: ${e}`,"PERMISSION_DENIED",e,t,n)}}class te extends m{constructor(e,t,n){super(e,"ENOSPC",t,"write",n)}}class Oe extends m{constructor(e,t,n){super(`Operation timed out: ${e}`,"TIMEOUT_ERROR",t,e,n)}}class se extends m{constructor(e,t){super(`File is busy: ${e}`,"EBUSY",e,"open",t)}}class C extends m{constructor(e,t,n,r){const i=t==="directory"?`Is a directory: ${n}`:`Not a directory: ${n}`,o=t==="directory"?"EISDIR":"ENOTDIR";super(i,o,n,"access",r)}}class b extends m{constructor(e,t,n,r){const i={argument:"EINVAL",format:"INVALID_FORMAT",descriptor:"EBADF",overflow:"ERANGE"};super(t,i[e],n,"validate",r)}}class ne extends m{constructor(e,t){super(`Operation aborted: ${e}`,"EINTR",e,"interrupt",t)}}class U extends m{constructor(e,t,n){super(e,"EIO",t,"io",n)}}class re extends m{constructor(e,t){super(`Operation not supported: ${e}`,"ENOTSUP",e,"operation",t)}}class W extends m{constructor(e,t,n){const r={remove:`Failed to remove entry: ${t}`,clear:`Directory not empty: ${t}. Use recursive option to force removal.`,root:"Cannot remove root directory"},i={remove:"RM_FAILED",clear:"ENOTEMPTY",root:"EROOT"};super(r[e],i[e],t,"unlink",n)}}class Ae extends m{constructor(e,t){super("Failed to initialize OPFS","INIT_FAILED",e,"init",t)}}class Ne extends m{constructor(e,t,n){super(`Failed to ${e}: ${t}`,`${e.toUpperCase()}_FAILED`,t,e,n)}}class be extends m{constructor(e,t){super(`Failed to resolve path: ${e}`,"REALPATH_FAILED",e,"realpath",t)}}class ve extends m{constructor(e,t){super(`Destination already exists: ${e}`,"EEXIST",e,"open",t)}}function $e(s,e,t,n){const r=`${s.toUpperCase()}_FAILED`;return new m(`Failed to ${s} file descriptor: ${e}`,r,t,s,n)}function ie(s,e){const t=e?.path,n=e?.isDirectory;switch(s.name){case"InvalidStateError":return new se(t||"unknown",s);case"QuotaExceededError":return new te(`No space left on device: ${t||"unknown"}`,t,s);case"NotFoundError":return new j("file",t,s);case"TypeMismatchError":return n!==void 0?n?new C("file","directory",t||"unknown",s):new C("directory","file",t||"unknown",s):new b("argument",`Type mismatch: ${t||"unknown"}`,t,s);case"NotAllowedError":case"SecurityError":return new ee(t,"unknown",s);case"InvalidModificationError":return new b("argument",`Invalid modification: ${t||"unknown"}`,t,s);case"AbortError":return new ne(t||"unknown",s);case"OperationError":return new U(`Operation failed: ${t||"unknown"}`,t,s);case"TypeError":return new re(t||"unknown",s);default:return new U(`I/O error: ${t||"unknown"}`,t,s)}}const oe=[".jpg",".jpeg",".png",".gif",".bmp",".webp",".ico",".tiff",".tga",".mp3",".wav",".ogg",".flac",".aac",".wma",".m4a",".mp4",".avi",".mov",".wmv",".flv",".webm",".mkv",".m4v",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".zip",".rar",".7z",".tar",".gz",".bz2",".exe",".dll",".so",".dylib",".dat",".db",".sqlite",".bin",".obj",".fbx",".3ds"];function Te(s){const e=s.lastIndexOf(".");if(e<=0)return!0;const t=s.slice(e).toLowerCase();return oe.includes(t)}function ce(s,e="utf-8"){switch(e){case"utf8":case"utf-8":return new TextEncoder().encode(s);case"utf16le":case"utf-16le":case"ucs2":case"ucs-2":return Re(s);case"ascii":return Ce(s);case"latin1":return Me(s);case"binary":return Uint8Array.from(s,t=>t.charCodeAt(0));case"base64":return Uint8Array.from(atob(s),t=>t.charCodeAt(0));case"hex":if(!/^[\da-f]+$/i.test(s)||s.length%2!==0)throw new b("format","Invalid hex string");return Uint8Array.from(s.match(/.{1,2}/g).map(t=>parseInt(t,16)));default:return console.warn("Encoding not supported, falling back to UTF-8"),new TextEncoder().encode(s)}}function Pe(s,e="utf-8"){switch(e){case"utf8":case"utf-8":return new TextDecoder().decode(s);case"utf16le":case"utf-16le":case"ucs2":case"ucs-2":return Ie(s);case"latin1":return String.fromCharCode(...s);case"ascii":return String.fromCharCode(...s.map(t=>t&127));case"base64":return btoa(String.fromCharCode(...s));case"hex":return Array.from(s).map(t=>t.toString(16).padStart(2,"0")).join("");default:return console.warn("Unsupported encoding, falling back to UTF-8"),new TextDecoder().decode(s)}}function Re(s){const e=new Uint8Array(s.length*2);for(let t=0;t<s.length;t++){const n=s.charCodeAt(t);e[t*2]=n&255,e[t*2+1]=n>>8}return e}function Ie(s){s.length%2!==0&&(console.warn("Invalid UTF-16LE buffer length, truncating last byte"),s=s.slice(0,s.length-1));const e=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2);return String.fromCharCode(...e)}function Me(s){const e=new Uint8Array(s.length);for(let t=0;t<s.length;t++)e[t]=s.charCodeAt(t)&255;return e}function Ce(s){const e=new Uint8Array(s.length);for(let t=0;t<s.length;t++)e[t]=s.charCodeAt(t)&127;return e}var ae=(s=>(s.Added="added",s.Changed="changed",s.Removed="removed",s))(ae||{});const le=(s,e,t)=>{const n=s instanceof RegExp?H(s,t):s,r=e instanceof RegExp?H(e,t):e,i=n!==null&&r!=null&&Fe(n,r,t);return i&&{start:i[0],end:i[1],pre:t.slice(0,i[0]),body:t.slice(i[0]+n.length,i[1]),post:t.slice(i[1]+r.length)}},H=(s,e)=>{const t=e.match(s);return t?t[0]:null},Fe=(s,e,t)=>{let n,r,i,o,a,l=t.indexOf(s),h=t.indexOf(e,l+1),c=l;if(l>=0&&h>0){if(s===e)return[l,h];for(n=[],i=t.length;c>=0&&!a;){if(c===l)n.push(c),l=t.indexOf(s,c+1);else if(n.length===1){const p=n.pop();p!==void 0&&(a=[p,h])}else r=n.pop(),r!==void 0&&r<i&&(i=r,o=h),h=t.indexOf(e,c+1);c=l<h&&l>=0?l:h}n.length&&o!==void 0&&(a=[i,o])}return a},he="\0SLASH"+Math.random()+"\0",ue="\0OPEN"+Math.random()+"\0",z="\0CLOSE"+Math.random()+"\0",fe="\0COMMA"+Math.random()+"\0",pe="\0PERIOD"+Math.random()+"\0",De=new RegExp(he,"g"),Le=new RegExp(ue,"g"),ke=new RegExp(z,"g"),Ue=new RegExp(fe,"g"),We=new RegExp(pe,"g"),je=/\\\\/g,ze=/\\{/g,Be=/\\}/g,_e=/\\,/g,qe=/\\./g;function k(s){return isNaN(s)?s.charCodeAt(0):parseInt(s,10)}function Ge(s){return s.replace(je,he).replace(ze,ue).replace(Be,z).replace(_e,fe).replace(qe,pe)}function He(s){return s.replace(De,"\\").replace(Le,"{").replace(ke,"}").replace(Ue,",").replace(We,".")}function de(s){if(!s)return[""];const e=[],t=le("{","}",s);if(!t)return s.split(",");const{pre:n,body:r,post:i}=t,o=n.split(",");o[o.length-1]+="{"+r+"}";const a=de(i);return i.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function Ve(s){return s?(s.slice(0,2)==="{}"&&(s="\\{\\}"+s.slice(2)),P(Ge(s),!0).map(He)):[]}function Ye(s){return"{"+s+"}"}function Xe(s){return/^-?0\d/.test(s)}function Ze(s,e){return s<=e}function Je(s,e){return s>=e}function P(s,e){const t=[],n=le("{","}",s);if(!n)return[s];const r=n.pre,i=n.post.length?P(n.post,!1):[""];if(/\$$/.test(n.pre))for(let o=0;o<i.length;o++){const a=r+"{"+n.body+"}"+i[o];t.push(a)}else{const o=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),l=o||a,h=n.body.indexOf(",")>=0;if(!l&&!h)return n.post.match(/,(?!,).*\}/)?(s=n.pre+"{"+n.body+z+n.post,P(s)):[s];let c;if(l)c=n.body.split(/\.\./);else if(c=de(n.body),c.length===1&&c[0]!==void 0&&(c=P(c[0],!1).map(Ye),c.length===1))return i.map(f=>n.pre+c[0]+f);let p;if(l&&c[0]!==void 0&&c[1]!==void 0){const f=k(c[0]),u=k(c[1]),g=Math.max(c[0].length,c[1].length);let d=c.length===3&&c[2]!==void 0?Math.abs(k(c[2])):1,S=Ze;u<f&&(d*=-1,S=Je);const v=c.some(Xe);p=[];for(let x=f;S(x,u);x+=d){let E;if(a)E=String.fromCharCode(x),E==="\\"&&(E="");else if(E=String(x),v){const $=g-E.length;if($>0){const I=new Array($+1).join("0");x<0?E="-"+I+E.slice(1):E=I+E}}p.push(E)}}else{p=[];for(let f=0;f<c.length;f++)p.push.apply(p,P(c[f],!1))}for(let f=0;f<p.length;f++)for(let u=0;u<i.length;u++){const g=r+p[f]+i[u];(!e||l||g)&&t.push(g)}}return t}const Qe=1024*64,F=s=>{if(typeof s!="string")throw new TypeError("invalid pattern");if(s.length>Qe)throw new TypeError("pattern is too long")},Ke={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},T=s=>s.replace(/[[\]\\-]/g,"\\$&"),et=s=>s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),V=s=>s.join(""),tt=(s,e)=>{const t=e;if(s.charAt(t)!=="[")throw new Error("not in a brace expression");const n=[],r=[];let i=t+1,o=!1,a=!1,l=!1,h=!1,c=t,p="";e:for(;i<s.length;){const d=s.charAt(i);if((d==="!"||d==="^")&&i===t+1){h=!0,i++;continue}if(d==="]"&&o&&!l){c=i+1;break}if(o=!0,d==="\\"&&!l){l=!0,i++;continue}if(d==="["&&!l){for(const[S,[N,v,x]]of Object.entries(Ke))if(s.startsWith(S,i)){if(p)return["$.",!1,s.length-t,!0];i+=S.length,x?r.push(N):n.push(N),a=a||v;continue e}}if(l=!1,p){d>p?n.push(T(p)+"-"+T(d)):d===p&&n.push(T(d)),p="",i++;continue}if(s.startsWith("-]",i+1)){n.push(T(d+"-")),i+=2;continue}if(s.startsWith("-",i+1)){p=d,i+=2;continue}n.push(T(d)),i++}if(c<i)return["",!1,0,!1];if(!n.length&&!r.length)return["$.",!1,s.length-t,!0];if(r.length===0&&n.length===1&&/^\\?.$/.test(n[0])&&!h){const d=n[0].length===2?n[0].slice(-1):n[0];return[et(d),!1,c-t,!1]}const f="["+(h?"^":"")+V(n)+"]",u="["+(h?"":"^")+V(r)+"]";return[n.length&&r.length?"("+f+"|"+u+")":n.length?f:u,a,c-t,!0]},R=(s,{windowsPathsNoEscape:e=!1}={})=>e?s.replace(/\[([^\/\\])\]/g,"$1"):s.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1"),st=new Set(["!","?","+","*","@"]),Y=s=>st.has(s),nt="(?!(?:^|/)\\.\\.?(?:$|/))",M="(?!\\.)",rt=new Set(["[","."]),it=new Set(["..","."]),ot=new Set("().*{}+?[]^$\\!"),ct=s=>s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),B="[^/]",X=B+"*?",Z=B+"+?";class y{type;#s;#n;#i=!1;#e=[];#t;#o;#a;#c=!1;#r;#l;#u=!1;constructor(e,t,n={}){this.type=e,e&&(this.#n=!0),this.#t=t,this.#s=this.#t?this.#t.#s:this,this.#r=this.#s===this?n:this.#s.#r,this.#a=this.#s===this?[]:this.#s.#a,e==="!"&&!this.#s.#c&&this.#a.push(this),this.#o=this.#t?this.#t.#e.length:0}get hasMagic(){if(this.#n!==void 0)return this.#n;for(const e of this.#e)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#n=!0;return this.#n}toString(){return this.#l!==void 0?this.#l:this.type?this.#l=this.type+"("+this.#e.map(e=>String(e)).join("|")+")":this.#l=this.#e.map(e=>String(e)).join("")}#p(){if(this!==this.#s)throw new Error("should only call on root");if(this.#c)return this;this.toString(),this.#c=!0;let e;for(;e=this.#a.pop();){if(e.type!=="!")continue;let t=e,n=t.#t;for(;n;){for(let r=t.#o+1;!n.type&&r<n.#e.length;r++)for(const i of e.#e){if(typeof i=="string")throw new Error("string part in extglob AST??");i.copyIn(n.#e[r])}t=n,n=t.#t}}return this}push(...e){for(const t of e)if(t!==""){if(typeof t!="string"&&!(t instanceof y&&t.#t===this))throw new Error("invalid part: "+t);this.#e.push(t)}}toJSON(){const e=this.type===null?this.#e.slice().map(t=>typeof t=="string"?t:t.toJSON()):[this.type,...this.#e.map(t=>t.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#s||this.#s.#c&&this.#t?.type==="!")&&e.push({}),e}isStart(){if(this.#s===this)return!0;if(!this.#t?.isStart())return!1;if(this.#o===0)return!0;const e=this.#t;for(let t=0;t<this.#o;t++){const n=e.#e[t];if(!(n instanceof y&&n.type==="!"))return!1}return!0}isEnd(){if(this.#s===this||this.#t?.type==="!")return!0;if(!this.#t?.isEnd())return!1;if(!this.type)return this.#t?.isEnd();const e=this.#t?this.#t.#e.length:0;return this.#o===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){const t=new y(this.type,e);for(const n of this.#e)t.copyIn(n);return t}static#h(e,t,n,r){let i=!1,o=!1,a=-1,l=!1;if(t.type===null){let u=n,g="";for(;u<e.length;){const d=e.charAt(u++);if(i||d==="\\"){i=!i,g+=d;continue}if(o){u===a+1?(d==="^"||d==="!")&&(l=!0):d==="]"&&!(u===a+2&&l)&&(o=!1),g+=d;continue}else if(d==="["){o=!0,a=u,l=!1,g+=d;continue}if(!r.noext&&Y(d)&&e.charAt(u)==="("){t.push(g),g="";const S=new y(d,t);u=y.#h(e,S,u,r),t.push(S);continue}g+=d}return t.push(g),u}let h=n+1,c=new y(null,t);const p=[];let f="";for(;h<e.length;){const u=e.charAt(h++);if(i||u==="\\"){i=!i,f+=u;continue}if(o){h===a+1?(u==="^"||u==="!")&&(l=!0):u==="]"&&!(h===a+2&&l)&&(o=!1),f+=u;continue}else if(u==="["){o=!0,a=h,l=!1,f+=u;continue}if(Y(u)&&e.charAt(h)==="("){c.push(f),f="";const g=new y(u,c);c.push(g),h=y.#h(e,g,h,r);continue}if(u==="|"){c.push(f),f="",p.push(c),c=new y(null,t);continue}if(u===")")return f===""&&t.#e.length===0&&(t.#u=!0),c.push(f),f="",t.push(...p,c),h;f+=u}return t.type=null,t.#n=void 0,t.#e=[e.substring(n-1)],h}static fromGlob(e,t={}){const n=new y(null,void 0,t);return y.#h(e,n,0,t),n}toMMPattern(){if(this!==this.#s)return this.#s.toMMPattern();const e=this.toString(),[t,n,r,i]=this.toRegExpSource();if(!(r||this.#n||this.#r.nocase&&!this.#r.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;const a=(this.#r.nocase?"i":"")+(i?"u":"");return Object.assign(new RegExp(`^${t}$`,a),{_src:t,_glob:e})}get options(){return this.#r}toRegExpSource(e){const t=e??!!this.#r.dot;if(this.#s===this&&this.#p(),!this.type){const l=this.isStart()&&this.isEnd(),h=this.#e.map(u=>{const[g,d,S,N]=typeof u=="string"?y.#d(u,this.#n,l):u.toRegExpSource(e);return this.#n=this.#n||S,this.#i=this.#i||N,g}).join("");let c="";if(this.isStart()&&typeof this.#e[0]=="string"&&!(this.#e.length===1&&it.has(this.#e[0]))){const g=rt,d=t&&g.has(h.charAt(0))||h.startsWith("\\.")&&g.has(h.charAt(2))||h.startsWith("\\.\\.")&&g.has(h.charAt(4)),S=!t&&!e&&g.has(h.charAt(0));c=d?nt:S?M:""}let p="";return this.isEnd()&&this.#s.#c&&this.#t?.type==="!"&&(p="(?:$|\\/)"),[c+h+p,R(h),this.#n=!!this.#n,this.#i]}const n=this.type==="*"||this.type==="+",r=this.type==="!"?"(?:(?!(?:":"(?:";let i=this.#f(t);if(this.isStart()&&this.isEnd()&&!i&&this.type!=="!"){const l=this.toString();return this.#e=[l],this.type=null,this.#n=void 0,[l,R(this.toString()),!1,!1]}let o=!n||e||t||!M?"":this.#f(!0);o===i&&(o=""),o&&(i=`(?:${i})(?:${o})*?`);let a="";if(this.type==="!"&&this.#u)a=(this.isStart()&&!t?M:"")+Z;else{const l=this.type==="!"?"))"+(this.isStart()&&!t&&!e?M:"")+X+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&o?")":this.type==="*"&&o?")?":`)${this.type}`;a=r+i+l}return[a,R(i),this.#n=!!this.#n,this.#i]}#f(e){return this.#e.map(t=>{if(typeof t=="string")throw new Error("string type in extglob ast??");const[n,r,i,o]=t.toRegExpSource(e);return this.#i=this.#i||o,n}).filter(t=>!(this.isStart()&&this.isEnd())||!!t).join("|")}static#d(e,t,n=!1){let r=!1,i="",o=!1;for(let a=0;a<e.length;a++){const l=e.charAt(a);if(r){r=!1,i+=(ot.has(l)?"\\":"")+l;continue}if(l==="\\"){a===e.length-1?i+="\\\\":r=!0;continue}if(l==="["){const[h,c,p,f]=tt(e,a);if(p){i+=h,o=o||c,a+=p-1,t=t||f;continue}}if(l==="*"){n&&e==="*"?i+=Z:i+=X,t=!0;continue}if(l==="?"){i+=B,t=!0;continue}i+=ct(l)}return[i,R(e),!!t,o]}}const at=(s,{windowsPathsNoEscape:e=!1}={})=>e?s.replace(/[?*()[\]]/g,"[$&]"):s.replace(/[?*()[\]\\]/g,"\\$&"),w=(s,e,t={})=>(F(e),!t.nocomment&&e.charAt(0)==="#"?!1:new D(e,t).match(s)),lt=/^\*+([^+@!?\*\[\(]*)$/,ht=s=>e=>!e.startsWith(".")&&e.endsWith(s),ut=s=>e=>e.endsWith(s),ft=s=>(s=s.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(s)),pt=s=>(s=s.toLowerCase(),e=>e.toLowerCase().endsWith(s)),dt=/^\*+\.\*+$/,gt=s=>!s.startsWith(".")&&s.includes("."),mt=s=>s!=="."&&s!==".."&&s.includes("."),Et=/^\.\*+$/,wt=s=>s!=="."&&s!==".."&&s.startsWith("."),yt=/^\*+$/,St=s=>s.length!==0&&!s.startsWith("."),xt=s=>s.length!==0&&s!=="."&&s!=="..",Ot=/^\?+([^+@!?\*\[\(]*)?$/,At=([s,e=""])=>{const t=ge([s]);return e?(e=e.toLowerCase(),n=>t(n)&&n.toLowerCase().endsWith(e)):t},Nt=([s,e=""])=>{const t=me([s]);return e?(e=e.toLowerCase(),n=>t(n)&&n.toLowerCase().endsWith(e)):t},bt=([s,e=""])=>{const t=me([s]);return e?n=>t(n)&&n.endsWith(e):t},vt=([s,e=""])=>{const t=ge([s]);return e?n=>t(n)&&n.endsWith(e):t},ge=([s])=>{const e=s.length;return t=>t.length===e&&!t.startsWith(".")},me=([s])=>{const e=s.length;return t=>t.length===e&&t!=="."&&t!==".."},Ee=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",J={win32:{sep:"\\"},posix:{sep:"/"}},$t=Ee==="win32"?J.win32.sep:J.posix.sep;w.sep=$t;const A=Symbol("globstar **");w.GLOBSTAR=A;const Tt="[^/]",Pt=Tt+"*?",Rt="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",It="(?:(?!(?:\\/|^)\\.).)*?",Mt=(s,e={})=>t=>w(t,s,e);w.filter=Mt;const O=(s,e={})=>Object.assign({},s,e),Ct=s=>{if(!s||typeof s!="object"||!Object.keys(s).length)return w;const e=w;return Object.assign((n,r,i={})=>e(n,r,O(s,i)),{Minimatch:class extends e.Minimatch{constructor(r,i={}){super(r,O(s,i))}static defaults(r){return e.defaults(O(s,r)).Minimatch}},AST:class extends e.AST{constructor(r,i,o={}){super(r,i,O(s,o))}static fromGlob(r,i={}){return e.AST.fromGlob(r,O(s,i))}},unescape:(n,r={})=>e.unescape(n,O(s,r)),escape:(n,r={})=>e.escape(n,O(s,r)),filter:(n,r={})=>e.filter(n,O(s,r)),defaults:n=>e.defaults(O(s,n)),makeRe:(n,r={})=>e.makeRe(n,O(s,r)),braceExpand:(n,r={})=>e.braceExpand(n,O(s,r)),match:(n,r,i={})=>e.match(n,r,O(s,i)),sep:e.sep,GLOBSTAR:A})};w.defaults=Ct;const we=(s,e={})=>(F(s),e.nobrace||!/\{(?:(?!\{).)*\}/.test(s)?[s]:Ve(s));w.braceExpand=we;const Ft=(s,e={})=>new D(s,e).makeRe();w.makeRe=Ft;const Dt=(s,e,t={})=>{const n=new D(e,t);return s=s.filter(r=>n.match(r)),n.options.nonull&&!s.length&&s.push(e),s};w.match=Dt;const Q=/[?*]|[+@!]\(.*?\)|\[|\]/,Lt=s=>s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");class D{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){F(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||Ee,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=t.windowsNoMagicRoot!==void 0?t.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const e of this.set)for(const t of e)if(typeof t!="string")return!0;return!1}debug(...e){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,this.globSet);const n=this.globSet.map(i=>this.slashSplit(i));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let r=this.globParts.map((i,o,a)=>{if(this.isWindows&&this.windowsNoMagicRoot){const l=i[0]===""&&i[1]===""&&(i[2]==="?"||!Q.test(i[2]))&&!Q.test(i[3]),h=/^[a-z]:/i.test(i[0]);if(l)return[...i.slice(0,4),...i.slice(4).map(c=>this.parse(c))];if(h)return[i[0],...i.slice(1).map(c=>this.parse(c))]}return i.map(l=>this.parse(l))});if(this.debug(this.pattern,r),this.set=r.filter(i=>i.indexOf(!1)===-1),this.isWindows)for(let i=0;i<this.set.length;i++){const o=this.set[i];o[0]===""&&o[1]===""&&this.globParts[i][2]==="?"&&typeof o[3]=="string"&&/^[a-z]:$/i.test(o[3])&&(o[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let n=0;n<e.length;n++)for(let r=0;r<e[n].length;r++)e[n][r]==="**"&&(e[n][r]="*");const{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):t>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(t=>{let n=-1;for(;(n=t.indexOf("**",n+1))!==-1;){let r=n;for(;t[r+1]==="**";)r++;r!==n&&t.splice(n,r-n)}return t})}levelOneOptimize(e){return e.map(t=>(t=t.reduce((n,r)=>{const i=n[n.length-1];return r==="**"&&i==="**"?n:r===".."&&i&&i!==".."&&i!=="."&&i!=="**"?(n.pop(),n):(n.push(r),n)},[]),t.length===0?[""]:t))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let r=1;r<e.length-1;r++){const i=e[r];r===1&&i===""&&e[0]===""||(i==="."||i==="")&&(t=!0,e.splice(r,1),r--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(t=!0,e.pop())}let n=0;for(;(n=e.indexOf("..",n+1))!==-1;){const r=e[n-1];r&&r!=="."&&r!==".."&&r!=="**"&&(t=!0,e.splice(n-1,2),n-=2)}}while(t);return e.length===0?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let n of e){let r=-1;for(;(r=n.indexOf("**",r+1))!==-1;){let o=r;for(;n[o+1]==="**";)o++;o>r&&n.splice(r+1,o-r);let a=n[r+1];const l=n[r+2],h=n[r+3];if(a!==".."||!l||l==="."||l===".."||!h||h==="."||h==="..")continue;t=!0,n.splice(r,1);const c=n.slice(0);c[r]="**",e.push(c),r--}if(!this.preserveMultipleSlashes){for(let o=1;o<n.length-1;o++){const a=n[o];o===1&&a===""&&n[0]===""||(a==="."||a==="")&&(t=!0,n.splice(o,1),o--)}n[0]==="."&&n.length===2&&(n[1]==="."||n[1]==="")&&(t=!0,n.pop())}let i=0;for(;(i=n.indexOf("..",i+1))!==-1;){const o=n[i-1];if(o&&o!=="."&&o!==".."&&o!=="**"){t=!0;const l=i===1&&n[i+1]==="**"?["."]:[];n.splice(i-1,2,...l),n.length===0&&n.push(""),i-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let n=t+1;n<e.length;n++){const r=this.partsMatch(e[t],e[n],!this.preserveMultipleSlashes);if(r){e[t]=[],e[n]=r;break}}return e.filter(t=>t.length)}partsMatch(e,t,n=!1){let r=0,i=0,o=[],a="";for(;r<e.length&&i<t.length;)if(e[r]===t[i])o.push(a==="b"?t[i]:e[r]),r++,i++;else if(n&&e[r]==="**"&&t[i]===e[r+1])o.push(e[r]),r++;else if(n&&t[i]==="**"&&e[r]===t[i+1])o.push(t[i]),i++;else if(e[r]==="*"&&t[i]&&(this.options.dot||!t[i].startsWith("."))&&t[i]!=="**"){if(a==="b")return!1;a="a",o.push(e[r]),r++,i++}else if(t[i]==="*"&&e[r]&&(this.options.dot||!e[r].startsWith("."))&&e[r]!=="**"){if(a==="a")return!1;a="b",o.push(t[i]),r++,i++}else return!1;return e.length===t.length&&o}parseNegate(){if(this.nonegate)return;const e=this.pattern;let t=!1,n=0;for(let r=0;r<e.length&&e.charAt(r)==="!";r++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}matchOne(e,t,n=!1){const r=this.options;if(this.isWindows){const d=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),S=!d&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),N=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),v=!N&&t[0]===""&&t[1]===""&&t[2]==="?"&&typeof t[3]=="string"&&/^[a-z]:$/i.test(t[3]),x=S?3:d?0:void 0,E=v?3:N?0:void 0;if(typeof x=="number"&&typeof E=="number"){const[$,I]=[e[x],t[E]];$.toLowerCase()===I.toLowerCase()&&(t[E]=$,E>x?t=t.slice(E):x>E&&(e=e.slice(x)))}}const{optimizationLevel:i=1}=this.options;i>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,a=0,l=e.length,h=t.length;o<l&&a<h;o++,a++){this.debug("matchOne loop");var c=t[a],p=e[o];if(this.debug(t,c,p),c===!1)return!1;if(c===A){this.debug("GLOBSTAR",[t,c,p]);var f=o,u=a+1;if(u===h){for(this.debug("** at the end");o<l;o++)if(e[o]==="."||e[o]===".."||!r.dot&&e[o].charAt(0)===".")return!1;return!0}for(;f<l;){var g=e[f];if(this.debug(`
globstar while`,e,f,t,u,g),this.matchOne(e.slice(f),t.slice(u),n))return this.debug("globstar found match!",f,l,g),!0;if(g==="."||g===".."||!r.dot&&g.charAt(0)==="."){this.debug("dot detected!",e,f,t,u);break}this.debug("globstar swallow a segment, and continue"),f++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,f,t,u),f===l))}let d;if(typeof c=="string"?(d=p===c,this.debug("string match",c,p,d)):(d=c.test(p),this.debug("pattern match",c,p,d)),!d)return!1}if(o===l&&a===h)return!0;if(o===l)return n;if(a===h)return o===l-1&&e[o]==="";throw new Error("wtf?")}braceExpand(){return we(this.pattern,this.options)}parse(e){F(e);const t=this.options;if(e==="**")return A;if(e==="")return"";let n,r=null;(n=e.match(yt))?r=t.dot?xt:St:(n=e.match(lt))?r=(t.nocase?t.dot?pt:ft:t.dot?ut:ht)(n[1]):(n=e.match(Ot))?r=(t.nocase?t.dot?Nt:At:t.dot?bt:vt)(n):(n=e.match(dt))?r=t.dot?mt:gt:(n=e.match(Et))&&(r=wt);const i=y.fromGlob(e,this.options).toMMPattern();return r&&typeof i=="object"&&Reflect.defineProperty(i,"test",{value:r}),i}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,n=t.noglobstar?Pt:t.dot?Rt:It,r=new Set(t.nocase?["i"]:[]);let i=e.map(l=>{const h=l.map(c=>{if(c instanceof RegExp)for(const p of c.flags.split(""))r.add(p);return typeof c=="string"?Lt(c):c===A?A:c._src});return h.forEach((c,p)=>{const f=h[p+1],u=h[p-1];c!==A||u===A||(u===void 0?f!==void 0&&f!==A?h[p+1]="(?:\\/|"+n+"\\/)?"+f:h[p]=n:f===void 0?h[p-1]=u+"(?:\\/|"+n+")?":f!==A&&(h[p-1]=u+"(?:\\/|\\/"+n+"\\/)"+f,h[p+1]=A))}),h.filter(c=>c!==A).join("/")}).join("|");const[o,a]=e.length>1?["(?:",")"]:["",""];i="^"+o+i+a+"$",this.negate&&(i="^(?!"+i+").+$");try{this.regexp=new RegExp(i,[...r].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;const n=this.options;this.isWindows&&(e=e.split("\\").join("/"));const r=this.slashSplit(e);this.debug(this.pattern,"split",r);const i=this.set;this.debug(this.pattern,"set",i);let o=r[r.length-1];if(!o)for(let a=r.length-2;!o&&a>=0;a--)o=r[a];for(let a=0;a<i.length;a++){const l=i[a];let h=r;if(n.matchBase&&l.length===1&&(h=[o]),this.matchOne(h,l,t))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return w.defaults(e).Minimatch}}w.AST=y;w.Minimatch=D;w.escape=at;w.unescape=R;function kt(){if(!("storage"in navigator)||!("getDirectory"in navigator.storage))throw new K}async function ye(s,e,t){return typeof navigator<"u"&&navigator.locks?.request?navigator.locks.request(`opfs:${s.replace(/\/+/g,"/")}`,{mode:e},t):t()}function L(s){return Array.isArray(s)?s:(s.startsWith("~/")?s.slice(2):s).split("/").filter(Boolean)}function _(s){return typeof s=="string"?s??"/":`/${s.join("/")}`}function q(s){const e=L(s);return e[e.length-1]||""}function Ut(s){const e=L(s);return e.pop(),_(e)}function G(s){return!s||s==="/"?"/":s.startsWith("~/")?`/${s.slice(2)}`:s.startsWith("/")?s:`/${s}`}function Wt(s,e=!1){return s=s.replace(/\/$/,""),e&&!s.includes("*")?`${s}/**`:s}function jt(s,e){return w(s,e,{dot:!0,matchBase:!0})}function zt(s,e){if(!e||Array.isArray(e)&&e.length===0)return!1;const t=G(s);return(Array.isArray(e)?e:[e]).some(r=>w(t,r,{dot:!0}))}function Bt(s){const e=G(s),t=L(e),n=[];for(const r of t)if(!(r==="."||r===""))if(r===".."){if(n.length===0)continue;n.pop()}else n.push(r);return _(n)}function _t(s){const e=q(s),t=e.lastIndexOf(".");return t<=0||t===e.length-1?"":e.slice(t)}function qt(s,e="utf-8"){return typeof s=="string"?ce(s,e):s instanceof Uint8Array?s:new Uint8Array(s)}async function Gt(s,e="SHA-1",t=50*1024*1024){if(s instanceof File&&(s=await s.arrayBuffer()),s.byteLength>t)throw new Error(`File size ${s.byteLength} bytes exceeds maximum allowed size ${t} bytes`);const n=new Uint8Array(s),r=await crypto.subtle.digest(e,n);return Array.from(new Uint8Array(r)).map(o=>o.toString(16).padStart(2,"0")).join("")}function Ht(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;return!0}async function Vt(s){const e=await s.arrayBuffer();return new Uint8Array(e)}async function Yt(s,e,t={}){const n=q(e);return ye(e,"exclusive",async()=>{const r=t.recursive??!1,i=t.force??!1;try{await s.removeEntry(n,{recursive:r})}catch(o){if(o.name==="NotFoundError"){if(!i)throw new j("file",e,o)}else throw o.name==="InvalidModificationError"?new W("clear",e,o):o.name==="TypeMismatchError"&&!r?new C("file","directory",e,o):new W("remove",e,o)}})}function Xt(s,e,t,n){if(!Number.isInteger(e)||!Number.isInteger(t))throw new b("argument","Invalid offset or length");if(e<0||t<0)throw new b("argument","Negative offset or length not allowed");if(e+t>s)throw new b("overflow","Operation would overflow buffer");if(n!=null&&(!Number.isInteger(n)||n<0))throw new b("argument","Invalid position")}function Zt(s,e,t){try{e.flush(),e.close()}catch(n){console.warn(`Warning: Failed to properly close file descriptor ${s} (${t}):`,n)}}function Jt(s,e,t){if(s>=t)return{isEOF:!0,actualLength:0};const n=Math.min(e,t-s);return n<=0?{isEOF:!0,actualLength:0}:{isEOF:!1,actualLength:n}}async function Qt(s,e){try{return await s.createSyncAccessHandle()}catch(t){throw ie(t,{path:e,isDirectory:!1})}}exports.AlreadyExistsError=ve;exports.BINARY_FILE_EXTENSIONS=oe;exports.DirectoryOperationError=W;exports.ExistenceError=j;exports.FileBusyError=se;exports.FileSystemOperationError=Ne;exports.FileTypeError=C;exports.IOError=U;exports.InitializationFailedError=Ae;exports.OPFSError=m;exports.OPFSNotSupportedError=K;exports.OperationAbortedError=ne;exports.OperationNotSupportedError=re;exports.PathError=xe;exports.PathResolutionFailedError=be;exports.PermissionError=ee;exports.StorageError=te;exports.TimeoutError=Oe;exports.ValidationError=b;exports.WatchEventType=ae;exports.basename=q;exports.buffersEqual=Ht;exports.calculateFileHash=Gt;exports.calculateReadLength=Jt;exports.checkOPFSSupport=kt;exports.convertBlobToUint8Array=Vt;exports.createBuffer=qt;exports.createFDError=$e;exports.createSyncHandleSafe=Qt;exports.decodeBuffer=Pe;exports.dirname=Ut;exports.encodeString=ce;exports.extname=_t;exports.isBinaryFileExtension=Te;exports.isPathExcluded=zt;exports.joinPath=_;exports.mapDomError=ie;exports.matchMinimatch=jt;exports.normalizeMinimatch=Wt;exports.normalizePath=G;exports.removeEntry=Yt;exports.resolvePath=Bt;exports.safeCloseSyncHandle=Zt;exports.splitPath=L;exports.validateReadWriteArgs=Xt;exports.withLock=ye;
//# sourceMappingURL=helpers-CF7A2WQG.cjs.map
